{"cells":[{"cell_type":"markdown","metadata":{"id":"aVcmIETZQHPt"},"source":["## A / B Testing: Chi-2 with Montana Library case study\n","\n","In this notebook we perform a Chi square test with data from the Library of Montana University case study, applying a post-hoc correction to perform pairwise tests and find the true winner.\n","\n","Scipy approach."]},{"cell_type":"markdown","metadata":{"id":"BD5u2LKrQHPx"},"source":["### Data reading\n","\n","The important pieces of information (clicks on each element of interest & visits on each page) are scattered around. Let's collect them:"]},{"cell_type":"code","execution_count":1,"metadata":{"id":"UkRmZnIbQHPy","executionInfo":{"status":"ok","timestamp":1677176571853,"user_tz":-60,"elapsed":2872,"user":{"displayName":"kalava sivalavanya","userId":"05755290286565672160"}}},"outputs":[],"source":["import pandas as pd\n","import numpy as np\n","pd.set_option(\"max_colwidth\", 1000)\n","pd.set_option(\"max_rows\", 1000)\n","\n","# Element list Homepage Version 1 - Interact, 5-29-2013.csv\n","url = 'https://drive.google.com/file/d/1Tj6Z4OtJqLBOW0z2fvuGS5EhZo8xTVM6/view?usp=sharing' \n","path = 'https://drive.google.com/uc?export=download&id='+url.split('/')[-2]\n","v1 = pd.read_csv(path)\n","\n","# Element list Homepage Version 2 - Connect, 5-29-2013.csv\n","url = 'https://drive.google.com/file/d/1qHBdOjUWvJpN-LTg1z2jpeA3mDXQjdch/view?usp=sharing' \n","path = 'https://drive.google.com/uc?export=download&id='+url.split('/')[-2]\n","v2 = pd.read_csv(path)\n","\n","# Element list Homepage Version 3 - Learn, 5-29-2013.csv\n","url = 'https://drive.google.com/file/d/1g8prRmy3hpVtL6zvkdCwXcgIV0CS48zr/view?usp=sharing' \n","path = 'https://drive.google.com/uc?export=download&id='+url.split('/')[-2]\n","v3 = pd.read_csv(path)\n","\n","# Element list Homepage Version 4 - Help, 5-29-2013.csv\n","url = 'https://drive.google.com/file/d/1I9bjXkxtiILDogeQmsWCCDlQtRZ8OSrs/view?usp=sharing' \n","path = 'https://drive.google.com/uc?export=download&id='+url.split('/')[-2]\n","v4 = pd.read_csv(path)\n","\n","# Element list Homepage Version 5 - Services, 5-29-2013.csv\n","url = 'https://drive.google.com/file/d/1noDp_jpdAL_LGxU3SPDxqP94pUCqisqW/view?usp=sharing' \n","path = 'https://drive.google.com/uc?export=download&id='+url.split('/')[-2]\n","v5 = pd.read_csv(path)"]},{"cell_type":"code","execution_count":2,"metadata":{"id":"01vrGGGdQHP0","executionInfo":{"status":"ok","timestamp":1677176574903,"user_tz":-60,"elapsed":242,"user":{"displayName":"kalava sivalavanya","userId":"05755290286565672160"}}},"outputs":[],"source":["# clicks on each element\n","v1_clicks = int(v1.loc[v1[\"Name\"]==\"INTERACT\"][\"No. clicks\"])\n","v2_clicks = int(v2.loc[v2[\"Name\"]==\"CONNECT\"][\"No. clicks\"])\n","v3_clicks = int(v3.loc[v3[\"Name\"]==\"LEARN\"][\"No. clicks\"])\n","v4_clicks = int(v4.loc[v4[\"Name\"]==\"HELP\"][\"No. clicks\"])\n","v5_clicks = int(v5.loc[v5[\"Name\"]==\"SERVICES\"][\"No. clicks\"])"]},{"cell_type":"code","execution_count":3,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"QFopuyf4QHP0","executionInfo":{"status":"ok","timestamp":1677176596356,"user_tz":-60,"elapsed":496,"user":{"displayName":"kalava sivalavanya","userId":"05755290286565672160"}},"outputId":"ac5153fc-ec2f-4828-cceb-aafba22fb3c5"},"outputs":[{"output_type":"stream","name":"stdout","text":["42 53 21 38 45\n"]}],"source":["print(v1_clicks, v2_clicks, v3_clicks, v4_clicks, v5_clicks)"]},{"cell_type":"code","execution_count":4,"metadata":{"id":"wyPQ1FlQQHP1","executionInfo":{"status":"ok","timestamp":1677176597846,"user_tz":-60,"elapsed":3,"user":{"displayName":"kalava sivalavanya","userId":"05755290286565672160"}}},"outputs":[],"source":["# visits on each page (they are in the last column of the second row, we read them manually)\n","v1_visits = 10283\n","v2_visits = 2742\n","v3_visits = 2747\n","v4_visits = 3180\n","v5_visits = 2064"]},{"cell_type":"markdown","metadata":{"id":"i8UNGXvhQHP2"},"source":["#### Click Through rate\n","\n","Defined as clicks / visits"]},{"cell_type":"code","execution_count":5,"metadata":{"id":"mQLyrfiQQHP3","executionInfo":{"status":"ok","timestamp":1677176599598,"user_tz":-60,"elapsed":4,"user":{"displayName":"kalava sivalavanya","userId":"05755290286565672160"}}},"outputs":[],"source":["# click-through rates\n","interact_rate = float(v1_clicks / v1_visits)\n","connect_rate = float(v2_clicks / v2_visits)\n","learn_rate = float(v3_clicks / v3_visits)\n","help_rate = float(v4_clicks / v4_visits)\n","services_rate = float(v5_clicks / v5_visits)"]},{"cell_type":"code","execution_count":6,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"lEyizFPxQHP3","executionInfo":{"status":"ok","timestamp":1677176601333,"user_tz":-60,"elapsed":19,"user":{"displayName":"kalava sivalavanya","userId":"05755290286565672160"}},"outputId":"d806f55e-d0d2-4d9a-8f6b-18c117d7d89c"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["      rates     names\n","4  0.021802  Services\n","1  0.019329   Connect\n","3  0.011950      Help\n","2  0.007645     Learn\n","0  0.004084  Interact"],"text/html":["\n","  <div id=\"df-5118100c-5231-4d61-9729-af4cb51e6067\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>rates</th>\n","      <th>names</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>4</th>\n","      <td>0.021802</td>\n","      <td>Services</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0.019329</td>\n","      <td>Connect</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0.011950</td>\n","      <td>Help</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0.007645</td>\n","      <td>Learn</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>0.004084</td>\n","      <td>Interact</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-5118100c-5231-4d61-9729-af4cb51e6067')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-5118100c-5231-4d61-9729-af4cb51e6067 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-5118100c-5231-4d61-9729-af4cb51e6067');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":6}],"source":["# CTR from worst to best\n","rates = pd.Series([interact_rate, connect_rate, learn_rate, help_rate, services_rate])\n","names = pd.Series([\"Interact\", \"Connect\", \"Learn\", \"Help\", \"Services\"])\n","\n","ctr_df = pd.DataFrame({\"rates\":rates, \"names\":names}).sort_values(\"rates\")\n","ctr_df.sort_values(\"rates\", ascending=False)"]},{"cell_type":"markdown","metadata":{"id":"HoFpg1KiQHP4"},"source":["#### Contingency table\n","\n","For observed values. We note clicks and no-clicks (defined as visits - clicks)"]},{"cell_type":"code","execution_count":7,"metadata":{"id":"L2fqknAvQHP4","executionInfo":{"status":"ok","timestamp":1677176616876,"user_tz":-60,"elapsed":821,"user":{"displayName":"kalava sivalavanya","userId":"05755290286565672160"}}},"outputs":[],"source":["# no-clicks\n","v1_noclick = v1_visits - v1_clicks\n","v2_noclick = v2_visits - v2_clicks\n","v3_noclick = v3_visits - v3_clicks\n","v4_noclick = v4_visits - v4_clicks\n","v5_noclick = v5_visits - v5_clicks"]},{"cell_type":"code","execution_count":9,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":112},"id":"KBqGulfZQHP4","executionInfo":{"status":"ok","timestamp":1677176940354,"user_tz":-60,"elapsed":290,"user":{"displayName":"kalava sivalavanya","userId":"05755290286565672160"}},"outputId":"7d7e326c-d825-402d-c9b8-7f7ce39435b7"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["          Interact  Connect  Learn  Help  Services\n","Click           42       53     21    38        45\n","No-click     10241     2689   2726  3142      2019"],"text/html":["\n","  <div id=\"df-b8b1aa72-058e-4c76-b240-e12791b460a0\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Interact</th>\n","      <th>Connect</th>\n","      <th>Learn</th>\n","      <th>Help</th>\n","      <th>Services</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>Click</th>\n","      <td>42</td>\n","      <td>53</td>\n","      <td>21</td>\n","      <td>38</td>\n","      <td>45</td>\n","    </tr>\n","    <tr>\n","      <th>No-click</th>\n","      <td>10241</td>\n","      <td>2689</td>\n","      <td>2726</td>\n","      <td>3142</td>\n","      <td>2019</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-b8b1aa72-058e-4c76-b240-e12791b460a0')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-b8b1aa72-058e-4c76-b240-e12791b460a0 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-b8b1aa72-058e-4c76-b240-e12791b460a0');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":9}],"source":["# contingency table as a pd.DataFrame creation\n","clicks = pd.Series([v1_clicks, v2_clicks, v3_clicks, v4_clicks, v5_clicks])\n","noclicks = pd.Series([v1_noclick, v2_noclick, v3_noclick, v4_noclick, v5_noclick])\n","\n","observed = pd.DataFrame(data = [clicks, noclicks])\n","observed.columns = [\"Interact\", \"Connect\", \"Learn\", \"Help\", \"Services\"]\n","observed.index = [\"Click\", \"No-click\"]\n","\n","observed"]},{"cell_type":"markdown","metadata":{"id":"8iXWEk2mQHP5"},"source":["## Scipy approach"]},{"cell_type":"code","execution_count":10,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"2b-wAkscQHP5","executionInfo":{"status":"ok","timestamp":1677177042158,"user_tz":-60,"elapsed":867,"user":{"displayName":"kalava sivalavanya","userId":"05755290286565672160"}},"outputId":"3e14d859-397e-4df8-8f63-141791286445"},"outputs":[{"output_type":"stream","name":"stdout","text":["p value: 4.852334301093838e-20\n"]}],"source":["from scipy import stats\n","chisq, pvalue, df, expected = stats.chi2_contingency(observed)\n","print(\"p value:\", pvalue)"]},{"cell_type":"code","execution_count":11,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"dUuTgzmPQHP5","executionInfo":{"status":"ok","timestamp":1677177045663,"user_tz":-60,"elapsed":240,"user":{"displayName":"kalava sivalavanya","userId":"05755290286565672160"}},"outputId":"0e99080e-af56-4132-bcae-13daf5924553"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["96.7432353798328"]},"metadata":{},"execution_count":11}],"source":["chisq"]},{"cell_type":"code","execution_count":12,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":112},"id":"Ag92D_UjQHP6","executionInfo":{"status":"ok","timestamp":1677177047759,"user_tz":-60,"elapsed":281,"user":{"displayName":"kalava sivalavanya","userId":"05755290286565672160"}},"outputId":"8fb50c16-b6b5-4b15-99ae-adab8f24722e"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["             0            1            2            3            4\n","0     97.36948    25.963932    26.011277    30.111344    19.543967\n","1  10185.63052  2716.036068  2720.988723  3149.888656  2044.456033"],"text/html":["\n","  <div id=\"df-aeea4eb6-07b4-43e0-8701-c108326953e3\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>0</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>3</th>\n","      <th>4</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>97.36948</td>\n","      <td>25.963932</td>\n","      <td>26.011277</td>\n","      <td>30.111344</td>\n","      <td>19.543967</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>10185.63052</td>\n","      <td>2716.036068</td>\n","      <td>2720.988723</td>\n","      <td>3149.888656</td>\n","      <td>2044.456033</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-aeea4eb6-07b4-43e0-8701-c108326953e3')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-aeea4eb6-07b4-43e0-8701-c108326953e3 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-aeea4eb6-07b4-43e0-8701-c108326953e3');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":12}],"source":["pd.DataFrame(expected)"]},{"cell_type":"markdown","metadata":{"id":"hFGzapmDQHP6"},"source":["## How do we decide who's the winner?\n","\n","Read about [Post Hoc Tests](https://alanarnholt.github.io/PDS-Bookdown2/post-hoc-tests-1.html) and find out whether we can declare a clear winner!"]},{"cell_type":"code","execution_count":13,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"l_fU6btSQHP6","executionInfo":{"status":"ok","timestamp":1677177715729,"user_tz":-60,"elapsed":368,"user":{"displayName":"kalava sivalavanya","userId":"05755290286565672160"}},"outputId":"2c015dd8-a24b-48f8-a15d-f0d1b9027cd1"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["      rates     names\n","4  0.021802  Services\n","1  0.019329   Connect\n","3  0.011950      Help\n","2  0.007645     Learn\n","0  0.004084  Interact"],"text/html":["\n","  <div id=\"df-130f1840-3c58-4623-b204-ead84e0b7c11\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>rates</th>\n","      <th>names</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>4</th>\n","      <td>0.021802</td>\n","      <td>Services</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0.019329</td>\n","      <td>Connect</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0.011950</td>\n","      <td>Help</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0.007645</td>\n","      <td>Learn</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>0.004084</td>\n","      <td>Interact</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-130f1840-3c58-4623-b204-ead84e0b7c11')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-130f1840-3c58-4623-b204-ead84e0b7c11 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-130f1840-3c58-4623-b204-ead84e0b7c11');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":13}],"source":["ctr_df.sort_values(\"rates\", ascending=False)"]},{"cell_type":"markdown","metadata":{"id":"rCbCfoogQHP6"},"source":["We have 10 possible dual tests to perform:\n","* Interact - Learn\n","* Interact - Help\n","* Interact - Connect\n","* Interact - Services\n","* Learn - Help\n","* Learn - Connect\n","* Learn - Services\n","* Help - Connect\n","* Help - Services\n","* Connect - Services"]},{"cell_type":"code","execution_count":14,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"QwKOK4eUQHP7","executionInfo":{"status":"ok","timestamp":1677177760389,"user_tz":-60,"elapsed":361,"user":{"displayName":"kalava sivalavanya","userId":"05755290286565672160"}},"outputId":"12cd2e58-c00d-4ca4-e15c-608a0d9f3432"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["0.01"]},"metadata":{},"execution_count":14}],"source":["alpha = 0.1\n","possible_combinations = 10\n","alpha_post_hoc = alpha / possible_combinations\n","np.round(alpha_post_hoc, 4)"]},{"cell_type":"markdown","metadata":{"id":"078NGyKqQHP7"},"source":["Let's do the 10 pair-wise tests, and pay close attention to the best performing version:"]},{"cell_type":"code","execution_count":15,"metadata":{"collapsed":true,"jupyter":{"outputs_hidden":true,"source_hidden":true},"colab":{"base_uri":"https://localhost:8080/"},"id":"LVu4jwWcQHP7","executionInfo":{"status":"ok","timestamp":1677184749840,"user_tz":-60,"elapsed":238,"user":{"displayName":"kalava sivalavanya","userId":"05755290286565672160"}},"outputId":"35c4b4ef-964b-40b6-c767-5495b19235c1"},"outputs":[{"output_type":"stream","name":"stdout","text":["2.2250331654688293e-16\n","True\n"]}],"source":["# interact vs connect\n","chisq, pvalue, df, expected = stats.chi2_contingency(observed.loc[:, [\"Interact\", \"Connect\"]])\n","print(pvalue)\n","print(pvalue < alpha_post_hoc)"]},{"cell_type":"code","execution_count":16,"metadata":{"collapsed":true,"jupyter":{"outputs_hidden":true,"source_hidden":true},"colab":{"base_uri":"https://localhost:8080/"},"id":"MAVsdAjIQHP7","executionInfo":{"status":"ok","timestamp":1677184822285,"user_tz":-60,"elapsed":234,"user":{"displayName":"kalava sivalavanya","userId":"05755290286565672160"}},"outputId":"21a3d23f-1e6b-4287-9f91-22a6781f691e"},"outputs":[{"output_type":"stream","name":"stdout","text":["0.025419824342152637\n","False\n"]}],"source":["# interact vs learn\n","chisq, pvalue, df, expected = stats.chi2_contingency(observed.loc[:, [\"Interact\", \"Learn\"]])\n","print(pvalue)\n","print(pvalue < alpha_post_hoc)"]},{"cell_type":"code","execution_count":17,"metadata":{"collapsed":true,"jupyter":{"outputs_hidden":true,"source_hidden":true},"colab":{"base_uri":"https://localhost:8080/"},"id":"wss3ENH3QHP8","executionInfo":{"status":"ok","timestamp":1677184852620,"user_tz":-60,"elapsed":242,"user":{"displayName":"kalava sivalavanya","userId":"05755290286565672160"}},"outputId":"1ed2e410-388c-4680-ffe1-94892487b4d4"},"outputs":[{"output_type":"stream","name":"stdout","text":["9.03599988558687e-07\n","True\n"]}],"source":["# interact vs help\n","chisq, pvalue, df, expected = stats.chi2_contingency(observed.loc[:, [\"Interact\", \"Help\"]])\n","print(pvalue)\n","print(pvalue < alpha_post_hoc)"]},{"cell_type":"code","execution_count":18,"metadata":{"collapsed":true,"jupyter":{"outputs_hidden":true,"source_hidden":true},"colab":{"base_uri":"https://localhost:8080/"},"id":"STOju9UAQHP8","executionInfo":{"status":"ok","timestamp":1677184857420,"user_tz":-60,"elapsed":310,"user":{"displayName":"kalava sivalavanya","userId":"05755290286565672160"}},"outputId":"615117a4-3680-4f7a-a93c-7dd07db64cb5"},"outputs":[{"output_type":"stream","name":"stdout","text":["0.00027678881264505827\n","True\n"]}],"source":["# connect vs learn\n","chisq, pvalue, df, expected = stats.chi2_contingency(observed.loc[:, [\"Connect\", \"Learn\"]])\n","print(pvalue)\n","print(pvalue < alpha_post_hoc)"]},{"cell_type":"code","execution_count":19,"metadata":{"collapsed":true,"jupyter":{"outputs_hidden":true,"source_hidden":true},"colab":{"base_uri":"https://localhost:8080/"},"id":"sKdPlJh2QHP8","executionInfo":{"status":"ok","timestamp":1677184872237,"user_tz":-60,"elapsed":229,"user":{"displayName":"kalava sivalavanya","userId":"05755290286565672160"}},"outputId":"a0a1647e-bb57-4d71-8e1d-69eb0668dee0"},"outputs":[{"output_type":"stream","name":"stdout","text":["0.02808815288948292\n","False\n"]}],"source":["# connect vs help\n","chisq, pvalue, df, expected = stats.chi2_contingency(observed.loc[:, [\"Connect\", \"Help\"]])\n","print(pvalue)\n","print(pvalue < alpha_post_hoc)"]},{"cell_type":"code","execution_count":20,"metadata":{"collapsed":true,"jupyter":{"outputs_hidden":true,"source_hidden":true},"colab":{"base_uri":"https://localhost:8080/"},"id":"xTa8nla9QHP8","executionInfo":{"status":"ok","timestamp":1677184881122,"user_tz":-60,"elapsed":303,"user":{"displayName":"kalava sivalavanya","userId":"05755290286565672160"}},"outputId":"aebaf581-2c98-4a71-9b9d-04740112b83a"},"outputs":[{"output_type":"stream","name":"stdout","text":["0.12512753088691322\n","False\n"]}],"source":["# learn vs help\n","chisq, pvalue, df, expected = stats.chi2_contingency(observed.loc[:, [\"Learn\", \"Help\"]])\n","print(pvalue)\n","print(pvalue < alpha_post_hoc)"]},{"cell_type":"code","execution_count":21,"metadata":{"collapsed":true,"jupyter":{"outputs_hidden":true,"source_hidden":true},"colab":{"base_uri":"https://localhost:8080/"},"id":"r0NwBzVkQHP8","executionInfo":{"status":"ok","timestamp":1677184886765,"user_tz":-60,"elapsed":216,"user":{"displayName":"kalava sivalavanya","userId":"05755290286565672160"}},"outputId":"0b8eeee7-762d-48a6-962a-2a95bc6bb359"},"outputs":[{"output_type":"stream","name":"stdout","text":["5.719451224375125e-18\n","True\n"]}],"source":["# services vs interact\n","chisq, pvalue, df, expected = stats.chi2_contingency(observed.loc[:, [\"Interact\", \"Services\"]])\n","print(pvalue)\n","print(pvalue < alpha_post_hoc)"]},{"cell_type":"code","execution_count":22,"metadata":{"collapsed":true,"jupyter":{"outputs_hidden":true,"source_hidden":true},"colab":{"base_uri":"https://localhost:8080/"},"id":"5R4Kf6XYQHP8","executionInfo":{"status":"ok","timestamp":1677184889551,"user_tz":-60,"elapsed":229,"user":{"displayName":"kalava sivalavanya","userId":"05755290286565672160"}},"outputId":"fbae52d0-28e0-482f-a051-76faa5058361"},"outputs":[{"output_type":"stream","name":"stdout","text":["5.0540996583731365e-05\n","True\n"]}],"source":["# services vs learn\n","chisq, pvalue, df, expected = stats.chi2_contingency(observed.loc[:, [\"Learn\", \"Services\"]])\n","print(pvalue)\n","print(pvalue < alpha_post_hoc)"]},{"cell_type":"code","execution_count":23,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"lJzHNqz8QHP8","executionInfo":{"status":"ok","timestamp":1677184894616,"user_tz":-60,"elapsed":448,"user":{"displayName":"kalava sivalavanya","userId":"05755290286565672160"}},"outputId":"fb95d913-cd7a-472e-9050-384e7e6fac35"},"outputs":[{"output_type":"stream","name":"stdout","text":["0.007370912499282061\n","True\n"]}],"source":["# services vs help\n","chisq, pvalue, df, expected = stats.chi2_contingency(observed.loc[:, [\"Help\", \"Services\"]])\n","print(pvalue)\n","print(pvalue < alpha_post_hoc)"]},{"cell_type":"code","execution_count":24,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ewgNQXnyQHP9","executionInfo":{"status":"ok","timestamp":1677184900881,"user_tz":-60,"elapsed":240,"user":{"displayName":"kalava sivalavanya","userId":"05755290286565672160"}},"outputId":"2aaa8b3c-8f14-4e05-effa-04baa01707c1"},"outputs":[{"output_type":"stream","name":"stdout","text":["0.6188771123975272\n","False\n"]}],"source":["# services vs connect\n","chisq, pvalue, df, expected = stats.chi2_contingency(observed.loc[:, [\"Connect\", \"Services\"]])\n","print(pvalue)\n","print(pvalue < alpha_post_hoc)"]},{"cell_type":"markdown","metadata":{"id":"AcePfd5GQHP9"},"source":["The difference between Services and Help is statistically significant, but the difference between Services and Connect is not. \n","\n","To decide the winner, we can:\n","\n","- Look at other metrics besides CTR.\n","- Refer to the qualitative research.\n","- Ask opinions to subject-matter experts.\n","- Redesign the experiment and run it again."]}],"metadata":{"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.8.5"},"colab":{"provenance":[{"file_id":"17t_-kRrl_5RJzKh6pvj2CvcJgWHgApER","timestamp":1677176503334}]}},"nbformat":4,"nbformat_minor":0}